local mod = FiendFolio
local itemConfig = Isaac.GetItemConfig()

-- Blacklist/whitelist for items that actually do something when stacked.
-- Check via `mod:IsItemStackable(itemID, summonableOnly)`.

-- Vanilla items that are summonable but really shouldn't be.
local SummonableButShouldNotBe = {
	[CollectibleType.COLLECTIBLE_MOMS_PURSE] = true,
	[CollectibleType.COLLECTIBLE_PAGEANT_BOY] = true,
	[CollectibleType.COLLECTIBLE_MISSING_NO] = true,
	[CollectibleType.COLLECTIBLE_DADS_LOST_COIN] = true,
	[CollectibleType.COLLECTIBLE_SCHOOLBAG] = true,
}

-- Vanilla items that do nothing when stacked.
local VanillaItemBlacklist = {
	CollectibleType.COLLECTIBLE_SPOON_BENDER,
	CollectibleType.COLLECTIBLE_BLOOD_OF_THE_MARTYR, -- Why doesn't this stack lol
	CollectibleType.COLLECTIBLE_NUMBER_ONE, -- Technically stacks, but hits the tears cap too quickly (kind of a problem with all tears ups...)
	CollectibleType.COLLECTIBLE_SKATOLE,
	CollectibleType.COLLECTIBLE_HALO_OF_FLIES, -- Stacks, but only once, and only adds a single fly. Maybe I could implement some kind of per-item limit...?
	CollectibleType.COLLECTIBLE_TRANSCENDENCE,
	CollectibleType.COLLECTIBLE_COMPASS,
	CollectibleType.COLLECTIBLE_CUPIDS_ARROW,
	CollectibleType.COLLECTIBLE_MAGNETO,
	CollectibleType.COLLECTIBLE_TREASURE_MAP,
	CollectibleType.COLLECTIBLE_MOMS_EYE,
	CollectibleType.COLLECTIBLE_LADDER,
	CollectibleType.COLLECTIBLE_BATTERY,
	CollectibleType.COLLECTIBLE_CHOCOLATE_MILK,
	CollectibleType.COLLECTIBLE_XRAY_VISION,
	CollectibleType.COLLECTIBLE_PHD,
	CollectibleType.COLLECTIBLE_LOKIS_HORNS,
	CollectibleType.COLLECTIBLE_SPIDER_BITE,
	CollectibleType.COLLECTIBLE_SPELUNKER_HAT,
	CollectibleType.COLLECTIBLE_COMMON_COLD,
	CollectibleType.COLLECTIBLE_PARASITE,
	CollectibleType.COLLECTIBLE_WAFER,
	CollectibleType.COLLECTIBLE_OUIJA_BOARD,
	CollectibleType.COLLECTIBLE_9_VOLT,
	CollectibleType.COLLECTIBLE_BOBBY_BOMB,
	CollectibleType.COLLECTIBLE_LUMP_OF_COAL,
	CollectibleType.COLLECTIBLE_GUPPYS_TAIL,
	CollectibleType.COLLECTIBLE_MOMS_PURSE,
	CollectibleType.COLLECTIBLE_BOBS_CURSE,
	CollectibleType.COLLECTIBLE_SCAPULAR,
	CollectibleType.COLLECTIBLE_BUM_FRIEND,
	CollectibleType.COLLECTIBLE_INFESTATION,
	CollectibleType.COLLECTIBLE_IPECAC,
	CollectibleType.COLLECTIBLE_TOUGH_LOVE,
	CollectibleType.COLLECTIBLE_MULLIGAN,
	CollectibleType.COLLECTIBLE_TECHNOLOGY_2,
	CollectibleType.COLLECTIBLE_HABIT,
	CollectibleType.COLLECTIBLE_BLOODY_LUST,
	CollectibleType.COLLECTIBLE_SPIRIT_OF_THE_NIGHT,
	CollectibleType.COLLECTIBLE_CELTIC_CROSS,
	CollectibleType.COLLECTIBLE_POLYPHEMUS,
	CollectibleType.COLLECTIBLE_MITRE,
	CollectibleType.COLLECTIBLE_FATE,
	CollectibleType.COLLECTIBLE_BLACK_BEAN,
	CollectibleType.COLLECTIBLE_HOLY_GRAIL,
	CollectibleType.COLLECTIBLE_DEAD_DOVE,
	CollectibleType.COLLECTIBLE_3_DOLLAR_BILL,
	CollectibleType.COLLECTIBLE_MOMS_KEY,
	CollectibleType.COLLECTIBLE_MOMS_EYESHADOW,
	CollectibleType.COLLECTIBLE_MIDAS_TOUCH,
	CollectibleType.COLLECTIBLE_HUMBLEING_BUNDLE,
	CollectibleType.COLLECTIBLE_FANNY_PACK,
	CollectibleType.COLLECTIBLE_SHARP_PLUG,
	CollectibleType.COLLECTIBLE_BUTT_BOMBS,
	CollectibleType.COLLECTIBLE_GNAWED_LEAF,
	CollectibleType.COLLECTIBLE_SPIDERBABY,
	CollectibleType.COLLECTIBLE_LOST_CONTACT,
	CollectibleType.COLLECTIBLE_ANEMIC,
	CollectibleType.COLLECTIBLE_GOAT_HEAD,
	CollectibleType.COLLECTIBLE_MOMS_WIG,
	CollectibleType.COLLECTIBLE_SAD_BOMBS,
	CollectibleType.COLLECTIBLE_RUBBER_CEMENT,
	CollectibleType.COLLECTIBLE_PYROMANIAC,
	CollectibleType.COLLECTIBLE_CRICKETS_BODY,
	CollectibleType.COLLECTIBLE_GIMPY,
	CollectibleType.COLLECTIBLE_PIGGY_BANK,
	CollectibleType.COLLECTIBLE_BALL_OF_TAR,
	CollectibleType.COLLECTIBLE_STOP_WATCH,
	CollectibleType.COLLECTIBLE_TINY_PLANET,
	CollectibleType.COLLECTIBLE_INFESTATION_2,
	CollectibleType.COLLECTIBLE_E_COLI,
	CollectibleType.COLLECTIBLE_INFAMY,
	CollectibleType.COLLECTIBLE_TRINITY_SHIELD,
	CollectibleType.COLLECTIBLE_TECH_5,
	CollectibleType.COLLECTIBLE_BLUE_MAP,
	CollectibleType.COLLECTIBLE_BFFS,
	CollectibleType.COLLECTIBLE_HIVE_MIND,
	CollectibleType.COLLECTIBLE_THERES_OPTIONS,
	CollectibleType.COLLECTIBLE_STARTER_DECK,
	CollectibleType.COLLECTIBLE_LITTLE_BAGGY,
	CollectibleType.COLLECTIBLE_BLOOD_CLOT,
	CollectibleType.COLLECTIBLE_HOT_BOMBS,
	CollectibleType.COLLECTIBLE_FIRE_MIND,
	CollectibleType.COLLECTIBLE_DARK_MATTER,
	CollectibleType.COLLECTIBLE_BLACK_CANDLE,
	CollectibleType.COLLECTIBLE_PROPTOSIS,
	CollectibleType.COLLECTIBLE_MISSING_PAGE_2,
	CollectibleType.COLLECTIBLE_BEST_BUD,
	CollectibleType.COLLECTIBLE_DARK_BUM,
	CollectibleType.COLLECTIBLE_TAURUS,
	CollectibleType.COLLECTIBLE_CANCER,
	CollectibleType.COLLECTIBLE_LEO,
	CollectibleType.COLLECTIBLE_VIRGO,
	CollectibleType.COLLECTIBLE_LIBRA,
	CollectibleType.COLLECTIBLE_SCORPIO,
	CollectibleType.COLLECTIBLE_SAGITTARIUS,
	CollectibleType.COLLECTIBLE_AQUARIUS,
	CollectibleType.COLLECTIBLE_EVES_MASCARA,
	CollectibleType.COLLECTIBLE_MAGGYS_BOW,
	CollectibleType.COLLECTIBLE_THUNDER_THIGHS,
	CollectibleType.COLLECTIBLE_STRANGE_ATTRACTOR,
	CollectibleType.COLLECTIBLE_CURSED_EYE,
	CollectibleType.COLLECTIBLE_MYSTERIOUS_LIQUID,
	CollectibleType.COLLECTIBLE_SOY_MILK,
	CollectibleType.COLLECTIBLE_MIND,
	CollectibleType.COLLECTIBLE_SOUL,
	CollectibleType.COLLECTIBLE_DEAD_ONION,
	CollectibleType.COLLECTIBLE_BROKEN_WATCH,
	CollectibleType.COLLECTIBLE_MATCH_BOOK,
	CollectibleType.COLLECTIBLE_TOXIC_SHOCK,
	CollectibleType.COLLECTIBLE_BOMBER_BOY,
	CollectibleType.COLLECTIBLE_CAR_BATTERY,
	CollectibleType.COLLECTIBLE_SCATTER_BOMBS,
	CollectibleType.COLLECTIBLE_STICKY_BOMBS,
	CollectibleType.COLLECTIBLE_EPIPHORA,
	CollectibleType.COLLECTIBLE_CONTINUUM,
	CollectibleType.COLLECTIBLE_CURSE_OF_THE_TOWER,
	CollectibleType.COLLECTIBLE_DEAD_EYE,
	CollectibleType.COLLECTIBLE_HOLY_LIGHT,
	CollectibleType.COLLECTIBLE_HOST_HAT,
	CollectibleType.COLLECTIBLE_RESTOCK,
	CollectibleType.COLLECTIBLE_BURSTING_SACK,
	CollectibleType.COLLECTIBLE_NUMBER_TWO,
	CollectibleType.COLLECTIBLE_PUPULA_DUPLEX,
	CollectibleType.COLLECTIBLE_PAY_TO_PLAY,
	CollectibleType.COLLECTIBLE_KEY_BUM,
	CollectibleType.COLLECTIBLE_BETRAYAL,
	CollectibleType.COLLECTIBLE_ZODIAC,
	CollectibleType.COLLECTIBLE_SERPENTS_KISS,
	CollectibleType.COLLECTIBLE_MARKED,
	CollectibleType.COLLECTIBLE_GODS_FLESH,
	CollectibleType.COLLECTIBLE_MAW_OF_THE_VOID,
	CollectibleType.COLLECTIBLE_SPEAR_OF_DESTINY,
	CollectibleType.COLLECTIBLE_EXPLOSIVO,
	CollectibleType.COLLECTIBLE_CHAOS,
	CollectibleType.COLLECTIBLE_PURITY,
	CollectibleType.COLLECTIBLE_ATHAME,
	CollectibleType.COLLECTIBLE_EMPTY_VESSEL,
	CollectibleType.COLLECTIBLE_EVIL_EYE,
	CollectibleType.COLLECTIBLE_LUSTY_BLOOD,
	CollectibleType.COLLECTIBLE_CAMBION_CONCEPTION,
	CollectibleType.COLLECTIBLE_IMMACULATE_CONCEPTION,
	CollectibleType.COLLECTIBLE_MORE_OPTIONS,
	CollectibleType.COLLECTIBLE_CROWN_OF_LIGHT,
	CollectibleType.COLLECTIBLE_DEEP_POCKETS,
	CollectibleType.COLLECTIBLE_FRUIT_CAKE,
	CollectibleType.COLLECTIBLE_BLACK_POWDER,
	CollectibleType.COLLECTIBLE_CIRCLE_OF_PROTECTION,
	CollectibleType.COLLECTIBLE_SACK_HEAD,
	CollectibleType.COLLECTIBLE_NIGHT_LIGHT,
	CollectibleType.COLLECTIBLE_HEAD_OF_THE_KEEPER,
	CollectibleType.COLLECTIBLE_GLITTER_BOMBS,
	CollectibleType.COLLECTIBLE_MY_SHADOW,
	CollectibleType.COLLECTIBLE_KIDNEY_STONE,
	CollectibleType.COLLECTIBLE_DARK_PRINCES_CROWN,
	CollectibleType.COLLECTIBLE_LEAD_PENCIL,
	CollectibleType.COLLECTIBLE_DOG_TOOTH,
	CollectibleType.COLLECTIBLE_DEAD_TOOTH,
	CollectibleType.COLLECTIBLE_LINGER_BEAN,
	CollectibleType.COLLECTIBLE_SHARD_OF_GLASS,
	CollectibleType.COLLECTIBLE_METAL_PLATE,
	CollectibleType.COLLECTIBLE_EYE_OF_GREED,
	CollectibleType.COLLECTIBLE_TAROT_CLOTH,
	CollectibleType.COLLECTIBLE_VARICOSE_VEINS,
	CollectibleType.COLLECTIBLE_COMPOUND_FRACTURE,
	CollectibleType.COLLECTIBLE_POLYDACTYLY,
	CollectibleType.COLLECTIBLE_CONE_HEAD,
	CollectibleType.COLLECTIBLE_BELLY_BUTTON,
	CollectibleType.COLLECTIBLE_SINUS_INFECTION,
	CollectibleType.COLLECTIBLE_GLAUCOMA,
	CollectibleType.COLLECTIBLE_PARASITOID,
	CollectibleType.COLLECTIBLE_EYE_OF_BELIAL,
	CollectibleType.COLLECTIBLE_GLYPH_OF_BALANCE,
	CollectibleType.COLLECTIBLE_CONTAGION,
	CollectibleType.COLLECTIBLE_KING_BABY,
	CollectibleType.COLLECTIBLE_YO_LISTEN,
	CollectibleType.COLLECTIBLE_ADRENALINE,
	CollectibleType.COLLECTIBLE_JACOBS_LADDER,
	CollectibleType.COLLECTIBLE_GHOST_PEPPER,
	CollectibleType.COLLECTIBLE_EUTHANASIA,
	CollectibleType.COLLECTIBLE_CAMO_UNDIES,
	CollectibleType.COLLECTIBLE_DUALITY,
	CollectibleType.COLLECTIBLE_EUCHARIST,
	CollectibleType.COLLECTIBLE_GREEDS_GULLET,
	CollectibleType.COLLECTIBLE_LARGE_ZIT,
	CollectibleType.COLLECTIBLE_LITTLE_HORN,
	CollectibleType.COLLECTIBLE_BACKSTABBER,
	CollectibleType.COLLECTIBLE_BROKEN_MODEM,
	CollectibleType.COLLECTIBLE_FAST_BOMBS,
	CollectibleType.COLLECTIBLE_JUMPER_CABLES,
	CollectibleType.COLLECTIBLE_TECHNOLOGY_ZERO,
	CollectibleType.COLLECTIBLE_LEPROSY,
	CollectibleType.COLLECTIBLE_POP,
	CollectibleType.COLLECTIBLE_DEATHS_LIST,
	CollectibleType.COLLECTIBLE_LACHRYPHAGY,
	CollectibleType.COLLECTIBLE_TRISAGION,
	CollectibleType.COLLECTIBLE_BLANKET,
	CollectibleType.COLLECTIBLE_MARBLES,
	CollectibleType.COLLECTIBLE_FLAT_STONE,
	CollectibleType.COLLECTIBLE_DADS_RING,
	CollectibleType.COLLECTIBLE_2SPOOKY,
	CollectibleType.COLLECTIBLE_EYE_SORE,
	CollectibleType.COLLECTIBLE_120_VOLT,
	CollectibleType.COLLECTIBLE_IT_HURTS,
	CollectibleType.COLLECTIBLE_ALMOND_MILK,
	CollectibleType.COLLECTIBLE_ROCK_BOTTOM,
	CollectibleType.COLLECTIBLE_NANCY_BOMBS,
	CollectibleType.COLLECTIBLE_DREAM_CATCHER,
	CollectibleType.COLLECTIBLE_PASCHAL_CANDLE,
	CollectibleType.COLLECTIBLE_BLOOD_OATH,
	CollectibleType.COLLECTIBLE_PLAYDOUGH_COOKIE,
	CollectibleType.COLLECTIBLE_MONSTRANCE,
	CollectibleType.COLLECTIBLE_INTRUDER,
	CollectibleType.COLLECTIBLE_DIRTY_MIND,
	CollectibleType.COLLECTIBLE_SPIRIT_SWORD,
	CollectibleType.COLLECTIBLE_ROCKET_IN_A_JAR,
	CollectibleType.COLLECTIBLE_BOOK_OF_VIRTUES,
	CollectibleType.COLLECTIBLE_SOL,
	CollectibleType.COLLECTIBLE_LUNA,
	CollectibleType.COLLECTIBLE_VENUS,
	CollectibleType.COLLECTIBLE_MARS,
	CollectibleType.COLLECTIBLE_JUPITER,
	CollectibleType.COLLECTIBLE_SATURNUS,
	CollectibleType.COLLECTIBLE_URANUS,
	CollectibleType.COLLECTIBLE_NEPTUNUS,
	CollectibleType.COLLECTIBLE_VOODOO_HEAD,
	CollectibleType.COLLECTIBLE_MEMBER_CARD,
	CollectibleType.COLLECTIBLE_OCULAR_RIFT,
	CollectibleType.COLLECTIBLE_BLOOD_BOMBS,
	CollectibleType.COLLECTIBLE_ROTTEN_TOMATO,
	CollectibleType.COLLECTIBLE_BIRTHRIGHT,
	CollectibleType.COLLECTIBLE_KNOCKOUT_DROPS,
	CollectibleType.COLLECTIBLE_AKELDAMA,
	CollectibleType.COLLECTIBLE_REVELATION,
	CollectibleType.COLLECTIBLE_BRIMSTONE_BOMBS,
	CollectibleType.COLLECTIBLE_4_5_VOLT,
	CollectibleType.COLLECTIBLE_STAR_OF_BETHLEHEM,
	CollectibleType.COLLECTIBLE_VASCULITIS,
	CollectibleType.COLLECTIBLE_GIANT_CELL,
	CollectibleType.COLLECTIBLE_TROPICAMIDE,
	CollectibleType.COLLECTIBLE_CARD_READING,
	CollectibleType.COLLECTIBLE_QUINTS,
	CollectibleType.COLLECTIBLE_TOOTH_AND_NAIL,
	CollectibleType.COLLECTIBLE_OPTIONS,
	CollectibleType.COLLECTIBLE_CANDY_HEART,
	CollectibleType.COLLECTIBLE_POUND_OF_FLESH,
	CollectibleType.COLLECTIBLE_REDEMPTION,
	CollectibleType.COLLECTIBLE_CRACKED_ORB,
	CollectibleType.COLLECTIBLE_EMPTY_HEART,
	CollectibleType.COLLECTIBLE_ASTRAL_PROJECTION,
	CollectibleType.COLLECTIBLE_C_SECTION,
	CollectibleType.COLLECTIBLE_MONTEZUMAS_REVENGE,
	CollectibleType.COLLECTIBLE_LIL_PORTAL,
	CollectibleType.COLLECTIBLE_BONE_SPURS,
	CollectibleType.COLLECTIBLE_HUNGRY_SOUL,
	CollectibleType.COLLECTIBLE_SOUL_LOCKET,
	CollectibleType.COLLECTIBLE_GLITCHED_CROWN,
	CollectibleType.COLLECTIBLE_JELLY_BELLY,
	CollectibleType.COLLECTIBLE_SACRED_ORB,
	CollectibleType.COLLECTIBLE_SANGUINE_BOND,
	CollectibleType.COLLECTIBLE_SWARM,
	CollectibleType.COLLECTIBLE_HEARTBREAK,
	CollectibleType.COLLECTIBLE_BLOODY_GUST,
	CollectibleType.COLLECTIBLE_SALVATION,
	CollectibleType.COLLECTIBLE_AZAZELS_RAGE,
	CollectibleType.COLLECTIBLE_ECHO_CHAMBER,
	CollectibleType.COLLECTIBLE_ISAACS_TOMB,
	CollectibleType.COLLECTIBLE_VENGEFUL_SPIRIT,
	CollectibleType.COLLECTIBLE_KEEPERS_SACK,
	CollectibleType.COLLECTIBLE_KEEPERS_KIN,
	CollectibleType.COLLECTIBLE_HYPERCOAGULATION,
	CollectibleType.COLLECTIBLE_IBS,
	CollectibleType.COLLECTIBLE_HEMOPTYSIS,
	CollectibleType.COLLECTIBLE_GHOST_BOMBS,
	CollectibleType.COLLECTIBLE_MISSING_NO,
	CollectibleType.COLLECTIBLE_SCHOOLBAG,
	-- Not summonable, for one reason or another.
	CollectibleType.COLLECTIBLE_MR_MEGA,
	CollectibleType.COLLECTIBLE_GUPPYS_COLLAR,
	CollectibleType.COLLECTIBLE_PLACENTA,
	CollectibleType.COLLECTIBLE_OLD_BANDAGE,
	CollectibleType.COLLECTIBLE_POKE_GO,
	CollectibleType.COLLECTIBLE_MUCORMYCOSIS,
	CollectibleType.COLLECTIBLE_DIVINE_INTERVENTION,
	CollectibleType.COLLECTIBLE_STAIRWAY,
	CollectibleType.COLLECTIBLE_BIRDS_EYE,
	CollectibleType.COLLECTIBLE_PURGATORY,
	CollectibleType.COLLECTIBLE_BINGE_EATER,
	CollectibleType.COLLECTIBLE_GUPPYS_EYE,
	CollectibleType.COLLECTIBLE_SPIRIT_SHACKLES,
	CollectibleType.COLLECTIBLE_VANISHING_TWIN,
	-- Revival items (also not summonable).
	--[[CollectibleType.COLLECTIBLE_ANKH,
	CollectibleType.COLLECTIBLE_JUDAS_SHADOW,
	CollectibleType.COLLECTIBLE_LAZARUS_RAGS,
	CollectibleType.COLLECTIBLE_DEAD_CAT,
	CollectibleType.COLLECTIBLE_1UP,
	CollectibleType.COLLECTIBLE_INNER_CHILD,]]
}
local IsBlacklistedVanillaItem = {}
for _, id in pairs(VanillaItemBlacklist) do
	IsBlacklistedVanillaItem[id] = true
end

-- Whitelist of stackable FF items.
local FiendFolioItemWhitelist = {
	mod.ITEM.COLLECTIBLE.PYROMANCY,
	mod.ITEM.COLLECTIBLE.LIL_FIEND,
	mod.ITEM.COLLECTIBLE.BABY_CRATER,
	mod.ITEM.COLLECTIBLE.MAMA_SPOOTER,
	mod.ITEM.COLLECTIBLE.RANDY_THE_SNAIL,
	mod.ITEM.COLLECTIBLE.CORN_KERNEL,
	mod.ITEM.COLLECTIBLE.GMO_CORN,
	mod.ITEM.COLLECTIBLE.COOL_SUNGLASSES,
	mod.ITEM.COLLECTIBLE.FIENDS_HORN,
	mod.ITEM.COLLECTIBLE.SPARE_RIBS,
	mod.ITEM.COLLECTIBLE.BACON_GREASE,
	mod.ITEM.COLLECTIBLE.DEVILS_UMBRELLA,
	--mod.ITEM.COLLECTIBLE.NUGGET_BOMBS,
	mod.ITEM.COLLECTIBLE.BEE_SKIN,
	mod.ITEM.COLLECTIBLE.PINHEAD,
	mod.ITEM.COLLECTIBLE.LIL_LAMB,
	mod.ITEM.COLLECTIBLE.GRABBER,
	mod.ITEM.COLLECTIBLE.IMP_SODA,
	--mod.ITEM.COLLECTIBLE.DADS_WALLET,
	mod.ITEM.COLLECTIBLE.BEGINNERS_LUCK,
	--mod.ITEM.COLLECTIBLE.DICHROMATIC_BUTTERFLY,
	--mod.ITEM.COLLECTIBLE.SLIPPYS_GUTS,
	--mod.ITEM.COLLECTIBLE.SLIPPYS_HEART,
	--mod.ITEM.COLLECTIBLE.COMMUNITY_ACHIEVEMENT,
	mod.ITEM.COLLECTIBLE.CHIRUMIRU,
	mod.ITEM.COLLECTIBLE.GOLEMS_ORB,
	mod.ITEM.COLLECTIBLE.LEFTOVER_TAKEOUT,
	--mod.ITEM.COLLECTIBLE.MODERN_OUROBOROS,
	mod.ITEM.COLLECTIBLE.PEACH_CREEP,
	mod.ITEM.COLLECTIBLE.GORGON,
	mod.ITEM.COLLECTIBLE.OPHIUCHUS,
	mod.ITEM.COLLECTIBLE.CETUS,
	mod.ITEM.COLLECTIBLE.DEIMOS,
	mod.ITEM.COLLECTIBLE.PET_ROCK,
	--mod.ITEM.COLLECTIBLE.BIRTHDAY_GIFT, --Would this one even be possible to work?
	--mod.ITEM.COLLECTIBLE.BLACK_LANTERN,
	mod.ITEM.COLLECTIBLE.CRUCIFIX,
	--mod.ITEM.COLLECTIBLE.PRANK_COOKIE,
	--mod.ITEM.COLLECTIBLE.DEVILS_HARVEST,
	mod.ITEM.COLLECTIBLE.RUBBER_BULLETS,
	mod.ITEM.COLLECTIBLE.THE_DELUXE,
	mod.ITEM.COLLECTIBLE.LIL_MINX,
	mod.ITEM.COLLECTIBLE.FETAL_FIEND,
	--mod.ITEM.COLLECTIBLE.SECRET_STASH,
	mod.ITEM.COLLECTIBLE.GLIZZY,
	mod.ITEM.COLLECTIBLE.FIEND_HEART,
	mod.ITEM.COLLECTIBLE.DEVILLED_EGG,
	mod.ITEM.COLLECTIBLE.TEA,
	mod.ITEM.COLLECTIBLE.FRAUDULENT_FUNGUS,
	mod.ITEM.COLLECTIBLE.SMALL_PIPE,
	mod.ITEM.COLLECTIBLE.SMALL_WOOD,
	--mod.ITEM.COLLECTIBLE.PEPPERMINT,
	--mod.ITEM.COLLECTIBLE.BLACK_MOON,
	--mod.ITEM.COLLECTIBLE.PAGE_OF_VIRTUES,
	mod.ITEM.COLLECTIBLE.BRIDGE_BOMBS,
	mod.ITEM.COLLECTIBLE.LAWN_DARTS,
	--mod.ITEM.COLLECTIBLE.TOY_PIANO,
	mod.ITEM.COLLECTIBLE.HYPNO_RING,
	--mod.ITEM.COLLECTIBLE.MUSCA,
	--mod.ITEM.COLLECTIBLE.MODEL_ROCKET,
	mod.ITEM.COLLECTIBLE.SIBLING_SYL,
	mod.ITEM.COLLECTIBLE.GREG_THE_EGG,
	mod.ITEM.COLLECTIBLE.FAMILIAR_FLY,
	--mod.ITEM.COLLECTIBLE.MONAS_HIEROGLYPHICA,
	--mod.ITEM.COLLECTIBLE.CYANIDE_DEADLY_DOSE,
	--mod.ITEM.COLLECTIBLE.DADS_POSTICHE,
	mod.ITEM.COLLECTIBLE.EXCELSIOR,
	mod.ITEM.COLLECTIBLE.GRIDDLED_CORN,
	--mod.ITEM.COLLECTIBLE.HAPPYHEAD_AXE,
	mod.ITEM.COLLECTIBLE.PENNY_ROLL,
	--mod.ITEM.COLLECTIBLE.EVIL_STICKER,
	mod.ITEM.COLLECTIBLE.WIMPY_BRO,
	mod.ITEM.COLLECTIBLE.ROBOBABY3,
	mod.ITEM.COLLECTIBLE.NYX,
	--mod.ITEM.COLLECTIBLE.TELEBOMBS,
	--mod.ITEM.COLLECTIBLE.DICE_GOBLIN,
	mod.ITEM.COLLECTIBLE.SPINDLE,
	--mod.ITEM.COLLECTIBLE.DEVILS_DAGGER,
	mod.ITEM.COLLECTIBLE.STRANGE_RED_OBJECT,
	mod.ITEM.COLLECTIBLE.D3,
	--mod.ITEM.COLLECTIBLE.EMOJI_GLASSES,
	mod.ITEM.COLLECTIBLE.SACK_OF_SPICY,
	--mod.ITEM.COLLECTIBLE.HEART_OF_CHINA,
	--mod.ITEM.COLLECTIBLE.DEVILS_ABACUS,
	mod.ITEM.COLLECTIBLE.X10KACHING,
	mod.ITEM.COLLECTIBLE.X10BATOOMKLING,
	mod.ITEM.COLLECTIBLE.X10BADUMP,
	mod.ITEM.COLLECTIBLE.X10BZZT,
	mod.ITEM.COLLECTIBLE.X10CHOMPCHOMP,
	--mod.ITEM.COLLECTIBLE.INFINITY_VOLT,
	--mod.ITEM.COLLECTIBLE.MIME_DEGREE,
	mod.ITEM.COLLECTIBLE.CRAZY_JACKPOT,
	mod.ITEM.COLLECTIBLE.CLUTCHS_CURSE,
	mod.ITEM.COLLECTIBLE.PET_PEEVE,
	mod.ITEM.COLLECTIBLE.MOMS_STOCKINGS,
	mod.ITEM.COLLECTIBLE.GOLDEN_POPSICLE,
	--mod.ITEM.COLLECTIBLE.TIME_ITSELF,
	mod.ITEM.COLLECTIBLE.HORNCOB,
	mod.ITEM.COLLECTIBLE.HOST_ON_TOAST,
	mod.ITEM.COLLECTIBLE.BAG_OF_BOBBIES,
	mod.ITEM.COLLECTIBLE.BOX_TOP,
	mod.ITEM.COLLECTIBLE.KINDA_EGG,
	mod.ITEM.COLLECTIBLE.DADS_DIP,
	mod.ITEM.COLLECTIBLE.SMASH_TROPHY,
	mod.ITEM.COLLECTIBLE.BOTTLE_OF_WATER,
	--mod.ITEM.COLLECTIBLE.FISTFUL_OF_ASH,
	--mod.ITEM.COLLECTIBLE.FIENDS_THIRD_LEG,
	--mod.ITEM.COLLECTIBLE.ISAAC_DOT_CHR,
	--mod.ITEM.COLLECTIBLE.DADS_BATTERY,
	mod.ITEM.COLLECTIBLE.ISAACD_EULOGY,
	--mod.ITEM.COLLECTIBLE.BRICK_FIGURE,
	--mod.ITEM.COLLECTIBLE.GOLDSHI_LUNCH,
	--mod.ITEM.COLLECTIBLE.TWINKLE_OF_CONTAGION,
	--mod.ITEM.COLLECTIBLE.TOKEN_BAG,
	mod.ITEM.COLLECTIBLE.GREEN_ORANGE,
	mod.ITEM.COLLECTIBLE.REHEATED_PIZZA,
	mod.ITEM.COLLECTIBLE.SPELLING_BEE,
	mod.ITEM.COLLECTIBLE.TOO_MANY_OPTIONS,
}
local IsWhitelistedFfItem = {}
for _, id in pairs(FiendFolioItemWhitelist) do
	IsWhitelistedFfItem[id] = true
end

-- Quick-lookup table of valid stackable items.
local StackableItems = {}

function mod:GetStackableItemsTable()
	return StackableItems
end

-- Populate the table.
for i=1, itemConfig:GetCollectibles().Size-1 do
	local item = itemConfig:GetCollectible(i)
	if item and item.Type ~= ItemType.ITEM_ACTIVE and not item:HasTags(ItemConfig.TAG_QUEST) then
		if i < CollectibleType.NUM_COLLECTIBLES then
			if not IsBlacklistedVanillaItem[i] then
				StackableItems[i] = true
			end
		elseif IsWhitelistedFfItem[i] then
			StackableItems[i] = true
		end
	end
end

function mod:AddStackableItems(tab)
	for _, id in pairs(tab) do
		StackableItems[id] = true
	end
end

local IsTaintedItem = {}

-- Whitelist items from other mods only on MC_POST_GAME_STARTED to make sure their globals exist.
mod:AddCallback(ModCallbacks.MC_POST_GAME_STARTED, function()
	if TaintedCollectibles then
		for _, id in pairs(TaintedCollectibles) do
			IsTaintedItem[id] = true
		end
		mod:AddStackableItems({
			TaintedCollectibles.BAD_ONION,
			TaintedCollectibles.ATLAS,
			TaintedCollectibles.COLORED_CONTACTS,
			TaintedCollectibles.D_PAD,
			TaintedCollectibles.POISONED_DART,
			TaintedCollectibles.RAW_SOYLENT,
			TaintedCollectibles.SKELETON_LOCK,
			TaintedCollectibles.THE_BOTTLE,
		})
	end
end)

-- Setting "summonableOnly" to true primarily excludes stuff that only has on-pickup effects, for item wisps or potentially items added directly to the player.
function mod:IsItemStackable(itemID, summonableOnly)
	local item = itemConfig:GetCollectible(itemID)
	if item then
		-- Tainted Treasures items aren't "summonable", but are ok here.
		if summonableOnly and not IsTaintedItem[itemID] and (item.Tags & ItemConfig.TAG_SUMMONABLE == 0 or SummonableButShouldNotBe[itemID]) then
			return false
		end
		return StackableItems[itemID]
	end
end
